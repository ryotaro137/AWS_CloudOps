# 実務シナリオ集：試験知識 → 現場での活用

## 目次
1. [監視・通知の自動化](#シナリオ1-監視通知の自動化)
2. [非準拠リソースの自動是正](#シナリオ2-非準拠リソースの自動是正)
3. [マルチアカウント初期設定の自動化](#シナリオ3-マルチアカウント初期設定の自動化)
4. [コスト削減提案の実務フロー](#シナリオ4-コスト削減提案書の実務フロー)
5. [インシデント対応の自動化](#シナリオ5-インシデント対応の自動化)
6. [パッチ管理の運用設計](#シナリオ6-パッチ管理の運用設計)

---

## シナリオ1: 監視・通知の自動化

### 試験で問われる知識
- CloudWatch Alarm → SNS → Lambda の連携
- EventBridge のイベントパターンフィルタリング

### 実務での構成パターン
```
CloudWatch Alarm (CPU > 80%, 5分)
  ↓
SNS Topic (ops-critical)
  ├→ Email (管理者)
  ├→ Lambda → Slack Webhook (チャットへの通知)
  └→ Lambda → PagerDuty (深夜のオンコール用)
```

### 副業での提案ポイント
- 重要度別にSNSトピックを分ける（critical / warning / info）
- Slack通知にはインスタンスID、リージョン、メトリクス値を含める
- ダッシュボードのURLをSlack通知に埋め込み、1クリックで詳細確認できるようにする
- 月次レポートとして「アラーム発生回数」と「平均復旧時間」を集計し、改善の証跡にする

---

## シナリオ2: 非準拠リソースの自動是正

### 試験で問われる知識
- AWS Config + SSM Automation の連携（Automated Remediation）
- 「最小限の運用負荷で自動修復」というキーワード

### 実務での構成パターン
```
AWS Config Rule (s3-bucket-public-read-prohibited)
  ↓ 非準拠検出
SSM Automation Runbook (AWS-DisableS3BucketPublicReadWrite)
  ↓ 自動実行
S3バケットのパブリックアクセスがブロックされる
  ↓
SNS通知 → 担当者にSlackで「自動是正しました」と報告
```

### 副業での提案ポイント
- まず「検知のみ（通知）」で導入 → 慣れたら「自動是正」へ段階的に移行する
- 自動是正の対象はリスクの低いものから開始（S3パブリックアクセスブロック等）
- 是正ログをS3に保存し、監査証跡として利用する
- Configのコンフォーマンスパックを使い、CISベンチマーク等の標準に準拠させる

---

## シナリオ3: マルチアカウント初期設定の自動化

### 試験で問われる知識
- CloudFormation StackSets（マルチアカウント・マルチリージョン展開）
- AWS Organizations の OU（組織単位）に対する自動デプロイ

### 実務での構成パターン
```
Organizations管理アカウント
  ↓ StackSets (サービスマネージド)
全メンバーアカウントに以下を一括展開:
  ├── CloudTrail の有効化
  ├── AWS Config の有効化 + 必須ルール
  ├── GuardDuty の有効化
  ├── デフォルトVPC削除用Lambda
  └── IAM パスワードポリシーの強化
```

### 副業での提案ポイント
- 「アカウント追加時に自動適用」機能を有効にすることで、将来の追加作業をゼロにできる
- テンプレートに「このリソースは StackSets で管理されています」というタグを付与し、手動変更を抑止する
- StackSetsのテンプレートをGitリポジトリで管理し、変更差分をPRでレビューする運用を提案する

---

## シナリオ4: コスト削減提案書の実務フロー

### 試験で問われる知識
- Compute Optimizer（分析期間: デフォルト14日、最大93日）
- Cost Explorer / Budgets / Cost Anomaly Detection

### 実務での提案フロー
```
1. 現状の月額コストを Cost Explorer で可視化
2. Compute Optimizer でリサイジング候補を抽出
3. Trusted Advisor で未使用リソース（EIP, EBS等）を特定
4. S3 Storage Lens / Intelligent-Tiering で保存コストを最適化
5. 上記を「年間削減見込み額」としてレポートにまとめる
```

### 副業での提案ポイント
- 提案書のフォーマット例：
  - 現状コスト: 月額¥○○万
  - 削減施策: 計5件
  - 削減見込み: 月額¥○○万（年間¥○○万）
  - 投資回収期間: 即時（設定変更のみ）
- 「コスト削減率 ◯◯%を達成」という実績は次の案件獲得にも直結する

---

## シナリオ5: インシデント対応の自動化

### 試験で問われる知識
- SSM OpsCenter / OpsItem
- EventBridge + SSM Automation

### 実務での構成パターン
```
EC2 StatusCheckFailed (EventBridge)
  ↓
SSM Automation: AWS-RestartEC2Instance
  ↓ 自動復旧
OpsItem 作成（調査用の記録）
  ↓
SNS → Slack通知「EC2 i-xxxx を自動復旧しました。OpsItemを確認してください」
```

### 副業での提案ポイント
- 自動復旧 + 人的確認のハイブリッドフロー：完全自動化は怖いので「まず復旧、後で人が確認」
- OpsItemに関連リソース情報を含めることで調査時間を短縮
- ランブック（SSM Documents）のカスタマイズは案件としてリピートされやすい

---

## シナリオ6: パッチ管理の運用設計

### 試験で問われる知識
- SSM Patch Manager（ベースライン、パッチグループ、メンテナンスウィンドウ）
- SSM Compliance ダッシュボード

### 実務での構成パターン
```
パッチベースライン（Critical + Security パッチ、公開7日後に自動承認）
  ↓ パッチグループ別に適用
  ├── PatchGroup=Dev   → 毎週水曜AM3:00に自動適用
  ├── PatchGroup=Stg   → 毎週木曜AM3:00に自動適用（Devで検証後）
  └── PatchGroup=Prod  → 毎月第2土曜AM3:00に適用（承認制）
  ↓
Compliance ダッシュボードで適用状況を可視化
```

### 副業での提案ポイント
- Dev → Stg → Prod の段階適用で安全性を担保する設計がクライアントに好まれる
- メンテナンスウィンドウの時間帯はビジネスの閑散期に合わせる
- コンプライアンスレポートを月次で自動生成し、監査対応に備える
